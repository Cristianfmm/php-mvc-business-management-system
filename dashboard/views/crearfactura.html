<style>
    body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
    }
    .factura-container {
        background: white;
        border-radius: 15px;
        padding: 30px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        max-width: 1200px;
        margin: 0 auto;
    }
    .factura-header {
        border-bottom: 3px solid #667eea;
        padding-bottom: 20px;
        margin-bottom: 30px;
    }
    .form-label {
        font-weight: 600;
        color: #333;
    }
    .form-control, .form-select {
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        padding: 10px;
    }
    .form-control:focus, .form-select:focus {
        border-color: #667eea;
        box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
    }
    .tabla-items {
        margin-top: 30px;
    }
    .tabla-items th {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        font-weight: 600;
        padding: 12px;
    }
    .tabla-items td {
        padding: 10px;
        vertical-align: middle;
    }
    .btn-agregar {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 10px 25px;
        border-radius: 8px;
        font-weight: 600;
        transition: all 0.3s;
    }
    .btn-agregar:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    .btn-eliminar {
        background: #dc3545;
        color: white;
        border: none;
        padding: 5px 15px;
        border-radius: 5px;
    }
    .totales-box {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 20px;
        margin-top: 30px;
    }
    .total-row {
        display: flex;
        justify-content: space-between;
        padding: 8px 0;
        font-size: 16px;
    }
    .total-final {
        font-size: 24px;
        font-weight: bold;
        color: #667eea;
        border-top: 2px solid #667eea;
        padding-top: 15px;
        margin-top: 15px;
    }
    .badge-custom {
        padding: 8px 15px;
        border-radius: 20px;
        font-size: 14px;
    }
</style>
<div class="factura-container">
    <div class="factura-header">
        <h2 class="mb-0">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#667eea" style="vertical-align: middle;">
                <rect x="3" y="3" width="18" height="18" rx="2"/>
                <line x1="3" y1="9" x2="21" y2="9"/>
                <line x1="9" y1="21" x2="9" y2="9"/>
            </svg>
            Nueva Factura Electrónica
        </h2>
    </div>

    <form id="formFactura">
        <div class="row">
            <!-- Cliente -->
            <div class="col-md-6 mb-3">
                <label class="form-label">Cliente *</label>
                <div class="input-group">
                    <select class="form-select" id="cliente_id" required>
                        <option value="">Seleccione un cliente...</option>
                    </select>
                    <button type="button" class="btn btn-outline-secondary" onclick="abrirModalCliente()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <line x1="12" y1="5" x2="12" y2="19"/>
                            <line x1="5" y1="12" x2="19" y2="12"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Fecha de Emisión -->
            <div class="col-md-3 mb-3">
                <label class="form-label">Fecha Emisión *</label>
                <input type="date" class="form-control" id="fecha_emision" required>
            </div>

            <!-- Fecha de Vencimiento -->
            <div class="col-md-3 mb-3">
                <label class="form-label">Fecha Vencimiento</label>
                <input type="date" class="form-control" id="fecha_vencimiento">
            </div>

            <!-- Método de Pago -->
            <div class="col-md-4 mb-3">
                <label class="form-label">Método de Pago</label>
                <select class="form-select" id="metodo_pago">
                    <option value="efectivo">Efectivo</option>
                    <option value="transferencia">Transferencia</option>
                    <option value="tarjeta">Tarjeta</option>
                    <option value="cheque">Cheque</option>
                </select>
            </div>

            <!-- Estado -->
            <div class="col-md-4 mb-3">
                <label class="form-label">Estado</label>
                <select class="form-select" id="estado">
                    <option value="pendiente">Pendiente</option>
                    <option value="pagada">Pagada</option>
                </select>
            </div>

            <!-- Prefijo -->
            <div class="col-md-4 mb-3">
                <label class="form-label">Prefijo</label>
                <input type="text" class="form-control" id="prefijo" value="FAC" maxlength="10">
            </div>
        </div>

        <!-- Agregar Productos -->
        <div class="row mt-4">
            <div class="col-12">
                <h5>Items de la Factura</h5>
            </div>
            <div class="col-md-5 mb-3">
                <label class="form-label">Producto/Servicio</label>
                <select class="form-select" id="producto_temp">
                    <option value="">Seleccione...</option>
                </select>
            </div>
            <div class="col-md-2 mb-3">
                <label class="form-label">Cantidad</label>
                <input type="number" class="form-control" id="cantidad_temp" value="1" min="1" step="0.01">
            </div>
            <div class="col-md-3 mb-3">
                <label class="form-label">Precio Unit.</label>
                <input type="number" class="form-control" id="precio_temp" readonly>
            </div>
            <div class="col-md-2 mb-3">
                <label class="form-label">&nbsp;</label>
                <button type="button" class="btn btn-agregar w-100" onclick="agregarItem()">
                    + Agregar
                </button>
            </div>
        </div>

        <!-- Tabla de Items -->
        <div class="tabla-items">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Producto</th>
                        <th width="100">Cant.</th>
                        <th width="150">P. Unit.</th>
                        <th width="80">IVA %</th>
                        <th width="150">Subtotal</th>
                        <th width="80">Acción</th>
                    </tr>
                </thead>
                <tbody id="tablaItems">
                    <tr>
                        <td colspan="6" class="text-center text-muted">No hay items agregados</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Totales -->
        <div class="row">
            <div class="col-md-8">
                <label class="form-label">Observaciones</label>
                <textarea class="form-control" id="observaciones" rows="3"></textarea>
            </div>
            <div class="col-md-4">
                <div class="totales-box">
                    <div class="total-row">
                        <span>Subtotal:</span>
                        <strong id="subtotalDisplay">$0</strong>
                    </div>
                    <div class="total-row">
                        <span>IVA:</span>
                        <strong id="ivaDisplay">$0</strong>
                    </div>
                    <div class="total-row">
                        <span>Descuento:</span>
                        <input type="number" class="form-control form-control-sm" id="descuento" value="0" min="0" style="width: 120px; display: inline-block;">
                    </div>
                    <div class="total-row total-final">
                        <span>TOTAL:</span>
                        <span id="totalDisplay">$0</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Botones -->
        <div class="row mt-4">
            <div class="col-12 text-end">
                <button type="button" class="btn btn-secondary btn-lg me-2" onclick="window.history.back()">
                    Cancelar
                </button>
                <button type="button" class="btn btn-agregar btn-lg" id="btn-agregar">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" style="vertical-align: middle;">
                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                        <polyline points="17 21 17 13 7 13 7 21"/>
                        <polyline points="7 3 7 8 15 8"/>
                    </svg>
                    Guardar Factura
                </button>
            </div>
        </div>
    </form>
</div>